<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Amy's Instant Camera</title>
<link rel="stylesheet" href="https://0melette.github.io/navbar.css">
<style>
  body {
    background-color: #ffddee;
    font-family: 'Comic Sans MS', cursive, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
  }

  .camera {
    background-color: #ffb6c1;
    border-radius: 30px;
    box-shadow: inset -4px -4px #ff99aa, inset 4px 4px #fff;
    width: 350px;
    height: 480px;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
    position: relative;
  }

  .screen {
    width: 250px;
    height: 180px;
    background-color: #000;
    border: 4px solid #333;
    border-radius: 10px;
    display: flex;
    justify-content: center;
    align-items: center;
    margin-top: 20px;
  }

  .screen img {
    max-width: 100%;
    max-height: 100%;
    border-radius: 8px;
  }

  .buttons {
    position: absolute;
    right: 20px;
    top: 100px;
    display: flex;
    flex-direction: column;
    gap: 15px;
  }

  .button {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    border: 2px solid #666;
    background-color: #ffdf5a;
    box-shadow: inset -2px -2px #fff, inset 2px 2px #cc9900;
    font-size: 16px;
    cursor: pointer;
  }

  .button:active {
    box-shadow: inset 2px 2px #fff, inset -2px -2px #cc9900;
  }

  .print-slot {
    width: 200px;
    height: 80px;
    background-color: #f5f5f5;
    border: 2px solid #ccc;
    border-radius: 8px;
    position: absolute;
    bottom: 30px;
    display: flex;
    justify-content: center;
    align-items: flex-end;
    overflow: hidden;
  }

  .print-photo {
    width: 180px;
    filter: grayscale(100%) blur(2px) contrast(1.3);
    transform: translateY(100%);
    opacity: 0;
  }

  .print-photo.show {
    animation: printout 3s ease-out forwards;
  }

  @keyframes printout {
    0% {
      transform: translateY(100%) scaleY(0.8);
      opacity: 0;
      filter: grayscale(100%) blur(2px) brightness(0.8);
    }
    50% {
      transform: translateY(20%) scaleY(1);
      opacity: 0.8;
      filter: grayscale(100%) blur(1.5px);
    }
    100% {
      transform: translateY(0);
      opacity: 1;
      filter: grayscale(0%) blur(0.5px) brightness(1.1);
    }
  }

  .indicator {
    position: absolute;
    right: 25px;
    top: 40px;
    display: flex;
    gap: 8px;
  }

  .led {
    width: 10px;
    height: 10px;
    border-radius: 50%;
  }

  .led.blue { background-color: #00f; }
  .led.green { background-color: #0f0; }
</style>
</head>
<body>
  <div id="navbar-container"></div>

  <div class="camera">
    <div class="indicator">
      <div class="led blue"></div>
      <div class="led green"></div>
    </div>

    <div class="screen">
      <img id="photo" src="" alt="Preview">
    </div>

    <div class="buttons">
      <button class="button" id="prev">◀</button>
      <button class="button" id="ok">✔</button>
      <button class="button" id="next">▶</button>
      <button class="button" id="print">★</button>
    </div>

    <div class="print-slot">
      <img id="print-photo" class="print-photo" src="" alt="Print Output">
    </div>
  </div>

<script>
  // Load navbar from main repo
  fetch('https://0melette.github.io/navbar.html')
    .then(r => r.text())
    .then(html => {
      document.getElementById('navbar-container').innerHTML = html;
    })
    .catch(err => console.error('Failed to load navbar:', err));

  let photos = [];
  let index = 0;
  const photo = document.getElementById('photo');
  const printPhoto = document.getElementById('print-photo');
  const printSound = new Audio('https://cdn.pixabay.com/audio/2021/09/13/audio_3e93956b4f.mp3'); // safe open sound

  // Custom API loader
  function loadPhotos() {
    fetch('https://omelette-cameraproject-nicumh-6050c5-148-135-138-113.traefik.me/photos')
      .then(r => r.json())
      .then(data => {
        photos = data.map(item => item.url.replace('_m.', '_b.'));
        if (photos.length > 0) {
          photo.src = photos[0];
        }
      })
      .catch(err => console.error('Failed to load photos:', err));
  }

  document.getElementById('next').onclick = () => {
    if (photos.length === 0) return;
    index = (index + 1) % photos.length;
    photo.src = photos[index];
  };

  document.getElementById('prev').onclick = () => {
    if (photos.length === 0) return;
    index = (index - 1 + photos.length) % photos.length;
    photo.src = photos[index];
  };

  document.getElementById('print').onclick = () => {
    if (photos.length === 0) return;
    printPhoto.src = photos[index];
    printPhoto.classList.remove('show');
    void printPhoto.offsetWidth; // reset animation
    printPhoto.classList.add('show');
    printSound.play();
  };

  loadPhotos();
</script>
</body>
</html>
